\section{Nielsen's Method}
\begin{questions}
\question By expressing the transposition: $(u_1,\ldots,u_i,\ldots,u_j,\ldots,u_n)\mapsto(u_1,\ldots,u_j,\ldots,u_i,\ldots,u_n)$ as a product of six elementary Nielsen transformations, prove that any permutation of $U$ can be effected by a regular Nielsen transformation.
  \begin{solution}
    We have
    \begin{align*}
      & \phantom{{}={}} (u_1,\ldots,u_i,\ldots,u_j,\ldots,u_n)(ij)(i')(ji)(j')(ij)(i') \\
      &= (u_1,\ldots,u_iu_j,\ldots,u_j,\ldots,u_n)(i')(ji)(j')(ij)(i') \\
      &= (u_1,\ldots,u_j^{-1}u_i^{-1},\ldots,u_j,\ldots,u_n)(ji)(j')(ij)(i') \\
      &= (u_1,\ldots,u_j^{-1}u_i^{-1},\ldots,u_i^{-1},\ldots,u_n)(j')(ij)(i') \\
      &= (u_1,\ldots,u_j^{-1}u_i^{-1},\ldots,u_i,\ldots,u_n)(ij)(i') \\
      &= (u_1,\ldots,u_j^{-1},\ldots,u_i,\ldots,u_n)(i') \\
      &= (u_1,\ldots,u_j,\ldots,u_i,\ldots,u_n).
    \end{align*}
    Thus the transposition $(u_1,\ldots,u_i,\ldots,u_j,\ldots,u_n)\mapsto(u_1,\ldots,u_j,\ldots,u_i,\ldots,u_n)$ can be written as the product $(ij)(i')(ji)(j')(ij)(i')$ of six elementary Nielsen transformations. Since every permutation can be written as a product of transpositions, it follows that any permutation of $U$ can be effected by a regular Nielsen transformation.
  \end{solution}

\question Let $\tau$ be the transformation of $U$ sending $u_i$ to $(u_i^\gamma u_j^\delta)^\varepsilon$, where $i\neq j$ and $\gamma,\delta,\varepsilon\in\{\pm1\}$, and fixing all other $u_k$. Show that $\tau$ is a regular Nielsen transformation.
  \begin{solution}
    Let $\tau_1,\pi_1$ be the identity Nielsen transformations, and $\sigma_1=(ij)$. Define $\tau_{-1}=(i')$, $\sigma_{-1}=(j')(ij)(j')$, and $\pi_{-1}=(i')$. Then $\tau_\gamma,\sigma_\delta,\pi_\varepsilon$ fix all $u_k$ with $k\neq i$. Moreover $\tau_\gamma$ sends $u_i$ to $u_i^{\gamma}$, $\sigma_\delta$ sends $u_i$ to $u_iu_j^{\delta}$, and $\pi_\varepsilon$ sends $u_i$ to $u_i^{\varepsilon}$. Therefore $\tau=\tau_\gamma\sigma_\delta\pi_\varepsilon$ is a regular Nielsen transformation.
  \end{solution}

\question Prove that, except in the trivial case $U=\{e\}$, (N3)$\implies$(N1).
  \begin{solution}
    If (N1) is false, then $e\in U$. Suppose then that there is an $a\in U$, $a\neq e$. Then $l(aea^{-1})=l(e)=0$, but $l(a)-l(e)+l(a^{-1})=2l(a)>0$, and $a,e,a^{-1}\in U^\pm$ with $a\neq e\neq a^{-1}$. Thus (N3) is false. Taking the contrapositive gives the result.
  \end{solution}

\question Let $U=(u_1,\ldots,u_n)$ be a basis for a subgroup $H$ of $F$, and $\tau$ a regular Nielsen transformation of $U$. Prove that $U\tau$ is a basis for $H$. (Hint: for $w\in H$, let $l(w)$, $l_\tau(w)$ denote the length of $w$ as a reduced word in $U$, $U\tau$ respectively. Then prove that $l_\tau(w)\geq l(w)/k$, when $\tau$ is an elementary Nielsen transformation of type (Tk), $k=1,2$.)

\question Prove that the ordering $\ll$ in the proof of Theorem 1 is a well-ordering on the pairs $w^\pm$ in $F\setminus E$.
  \begin{solution}
    The ordering is defined as $w_1^\pm \ll w_2^\pm$ if and only if
    \begin{enumerate}[label=(\alph*)]
    \item $l(w_1)<l(w_2)$, or these are equal and either
    \item $\min\{L(w_1),L(w_1^{-1})\}<\min\{L(w_2),L(w_2^{-1})\}$, or
    \item these mins are equal, and $\max\{L(w_1), L(w_1^{-1})\}<\max\{L(w_2), L(w_2^{-1})\}$,
    \end{enumerate}
    where $L(w)$ is the first $\lfloor (l(w)+1)/2 \rfloor$ letters of $w$. Since $l(w)=l(w^{-1})$, (a) is well-defined on the pairs $w^\pm$ in $F\setminus E$. The max and min functions are symmetric in their arguments, so conditions (b) and (c) are also well-defined on these pairs.

    Clearly, at most one of $w_1^\pm\ll w_2^\pm$ and $w_2^\pm \ll w_1^\pm$ can hold. Suppose neither hold. WLOG $\min\{L(w_1),L(w_1^{-1})\}=L(w_1)$, and $\min\{L(w_2),L(w_2^{-1})\}=L(w_2)$. It follows that $L(w_1)=L(w_2)$, and $L(w_1^{-1})=L(w_2^{-1})$. Thus the first and second halves of $w_1$ are equal to the first and second halves of $w_2$, hence $w_1=w_2$.

    Suppose that $w_1^\pm\ll w_2^\pm$ and $w_2^\pm\ll w_3^\pm$ hold. Then $l(w_1)\leq l(w_2)\leq l(w_3)$. If any one of these inequalities is strict, then $l(w_1)<l(w_3)$ and so $w_1\ll w_3$. Suppose then that $l(w_1)=l(w_2)=l(w_3)$. WLOG $\min\{L(w_i),L(w_i^{-1})\}=L(w_i)$.

    Then $L(w_1)\leq L(w_2)\leq L(w_3)$. If any one of these inequalities is strict, then $L(w_1)<L(w_3)$ and so $w_1\ll w_3$. Suppose then that $L(w_1)=L(w_2)=L(w_3)$. Then $L(w_1^{-1})<L(w_2^{-1})<L(w_3^{-1})$, so $L(w_1^{-1})<L(w_3^{-1})$, hence $w_1\ll w_3$.

    It follows that $\ll$ is a total order. Let $S$ be a non-empty subset of the pairs $w^\pm$ in $F\setminus E$. Let $S_a$ denote the subset of $S$ consisting of the pairs $w^\pm$ in $S$ with minimum length. Let $S_b$ denote the subset of $S_a$ consisting of the pairs $w^\pm$ in $S_a$, with $\min\{L(w),L(w^{-1})\}$ minimal. Finally let $S_c$ denote the subset of $S_b$ consisting of the pairs $w^\pm$ in $S_b$ with $\max\{L(w),L(w^{-1})\}$ minimal. Then $S_a,S_b,S_c\neq\emptyset$.

    It is clear that for all $w_1^\pm\in S_c$ and $w_2^\pm\in S\setminus S_c$ we have $w_1^\pm\ll w_2^\pm$. Also for all $w_1^\pm,w_2^\pm\in S_c$, neither $w_1^\pm\ll w_2^\pm$ nor $w_2^\pm\ll w_1^\pm$ holds, which implies $w_1^\pm=w_2^\pm$. Thus $S_c$ consists of a single element, which is the minimal element of $S$. Hence $\ll$ is a well-ordering.
  \end{solution}

\question Let $H$ be the subgroup $\overline{\{x^3, y^2, x^{-1}y^{-1}xy\}}$ of $F(\{x,y\})$ studied in Chapter 2. Find Schreier generators $B$ of $H$ using the Schreier transversal $\{e,x,x^2,y,xy,x^2y\}$. Describe a Nielsen transformation $\tau$ such that $B\tau$ is $N$-reduced.
  \begin{solution}
    We have that
    \begin{align*}
      B &= \{ uz\overline{uz}^{-1} \mid u\in U, z\in \{x,y\}, uz\notin U \} \\
        &= \{ x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x^{-2}, xy^2x^{-1}, x^2yxy^{-1}, x^2y^2x^{-2} \}.
    \end{align*}
    We think of $B$ having the ordering above. Note that (N2) fails for $B$, in particular $l((xyxy^{-1}x^{-2})x^3)=l(xyxy^{-1}x)<l(xyxy^{-1}x^{-2})$. Thus replacing $B$ by $B(41)$ fixes this issue. Still $l((x^2yxy^{-1})^{-1}x^3)=l(yx^{-1}y^{-1}x)<l(x^2yxy^{-1})$, so replacing $B(41)$ by $B(41)(6')(61)$ fixes this issue. Finally $l((x^2y^2x^{-2})x^3)=l(x^2y^2x)<l(x^2y^2x^{-2})$, so we should replace $B(41)(6')(61)$ with $B(41)(6')(61)(71)$. But still, $l((x^2y^2x)^{-1}x^3)=l(x^{-1}y^{-2}x)<l(x^2y^2x)$, so replacing what we have with $B(41)(6')(61)(71)(7')(71)$ will fix this.

    This leaves us with
    \begin{align*}
      B' &\coloneqq B(41)(6')(61)(71)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x^{-2}, xy^2x^{-1}, x^2yxy^{-1}, x^2y^2x^{-2})(41)(6')(61)(71)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, x^2yxy^{-1}, x^2y^2x^{-2})(6')(61)(71)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, yx^{-1}y^{-1}x^{-2}, x^2y^2x^{-2})(61)(71)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, yx^{-1}y^{-1}x, x^2y^2x^{-2})(71)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, yx^{-1}y^{-1}x, x^2y^2x)(7')(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, yx^{-1}y^{-1}x, x^{-1}y^{-2}x^{-2})(71) \\
          &= (x^3, yxy^{-1}x^{-1}, y^2, xyxy^{-1}x, xy^2x^{-1}, yx^{-1}y^{-1}x, x^{-1}y^{-2}x)
    \end{align*}
    We can see that $B'$ satisfies (N2), and also (N1). The only places in which (N3) can fail in $B_1$ are if we find $a,b,c\in B_1^\pm$ with $a\neq b^{-1}\neq c$, and $l(abc)\leq l(a)-l(b)+l(c)$, which can only occur if exactly half of $b$ and is cancelled in forming both $ab$ and $bc$.

    No such cancellation can occur. Thus (N3) also holds in $B'$, and thus $\tau=(41)(6')(61)(71)(7')(71)$ is the required Nielsen transformation.
  \end{solution}

  \stepcounter{question}

% \question Let $U$ be a Schreier transversal for a subgroup $H$ of $F(X)$ such that $u$ is of minimal length in $Hu$, for all $u\in U$. Prove that the Schreier basis $B$ is $N$-reduced.

\question Let $\phi\colon F(X)\twoheadrightarrow F(Y)$ be an epimorphism of free groups with $\abs{X}$ finite. Prove that $\abs{Y}$ is finite.
  \begin{solution}
    Since $F(X)=\langle X \rangle$, and $\phi$ is onto, it follows that $F(Y)=\langle X\phi \rangle$. Let $\tau$ be a Nielsen transformation such that $U=(X\phi)\tau$ is N-reduced. Then $U$ is a basis for $F(Y)$, and $\abs{U}\leq\abs{X\phi}\leq\abs{X}$ is finite. Since $Y$ is also basis for $F(Y)$, it follows that $\abs{Y}=\abs{U}$ is finite.
  \end{solution}

\question With $\phi$ as in the previous exercise, prove that $F(X)$ has a basis $V=V_1\cup V_2$ such that $\phi$ maps $V_1$ one-to-one onto a basis for $F(Y)$ and $V_2$ into $E$. (\emph{Hint:} Let $\tau$ be a Nielsen transformation carrying $X\phi$ into $Y$, and examine the effect of $\tau$ on $X$.)
  \begin{solution}
    Let $\tau$ be as in the previous exercise. We can think of $\tau$ as acting on $X$ in the following way. Suppose that $X=(x_1,\ldots,x_n)$ and $X\phi=(y_1,\ldots,y_m)$. When we encounter a (T1) transformation $(i')$ in $\tau$, we apply $(k')$ to the current $X$, for all $k$ such that $x_k\phi=y_i$. Note all such $(k')$ commute.

    Similarly when we encounter a (T2) transformation $(ij)$, we apply $(k\ell)$ to the current $X$, for all $k$ and for some $\ell$ such that $x_k\phi=y_i$ and $x_\ell\phi=y_j$. Note all such $(k\ell)$ commute. For a (T0) transformation we do nothing, but collect all affected entries into a set $V_2$ at the end, and all remaining members into a set $V_1$.

    If we set $V=X\tau$, where $\tau$ acting on $X$ is described above, then $V=V_1\cup V_2$. It is clear from the definitions of elementary Nielsen transformations, that $(V_1\tau)\phi=(X\phi)\tau$. Also $v\phi=e$ for all $v\in V_2$. Since $\tau$ acting on $X$ consists of only applying (T1) and (T2) Nielsen transformations, it follows that $V$ is a basis for $F(X)$.
  \end{solution}

\question Prove that if a free group $F$ contains an ascending chain of subgroups
  \[ H_1\subseteq H_2\subseteq\cdots\subseteq H_n\subseteq H_{n+1}\subseteq\cdots \]
  each characteristic in the next, then $H_i=H_j$ for all $i,j\geq$ some $N\in\N$.
  \begin{solution}
    Let $l_n=\min\{l(w) \mid e\neq w\in H_n\}$. Then $l_1\geq l_2\geq l_3\geq\cdots$. Since $l_n\in\N$, follows that for some $N\in\N$, $l_i=l_N$ for all $i\geq N$. Let $w\in H_N$ satisfy $l(w)=l_N$. We will show that $H_i=H_{i+1}$ for each $i\geq N$.

    Suppose $i\geq N$, and let $w\in H_i$ satisfy $l(w)=l_i=l_{i+1}$. Then there is a basis $B$ of $H_{i+1}$ containing $w$. For each $b\in B$, the automorphism of $H_{i+1}$ determined by interchanging $w$ and $b$ must fix $H_i$. This proves that $B\subset H_i$. Since $H_{i+1}=\langle B \rangle$, we have $H_i=H_{i+1}$. Thus $H_i=H_j$ for all $i,j\geq N$.
  \end{solution}

\question Let $\phi$ be an automorphism of $F(\{x,y\})$ and let $c=x^{-1}y^{-1}xy$. Prove that $c\phi=w^{-1}c^{\pm1}w$ for some $w\in F$.
  \begin{solution}
    For a regular Nielsen transformation $\tau$, let $\phi_\tau$ denote the homomorphism of $F(\{x,y\})$ which extends $\tau$. Then since $X\tau$ is a basis, $\phi_\tau$ is an automorphism.
    \begin{align*}
      c\phi_{(1)} &= (x^{-1}y^{-1}xy)\phi_{(1)}=xy^{-1}x^{-1}y=xc^{-1}x^{-1} \\
      c\phi_{(2)} &= (x^{-1}y^{-1}xy)\phi_{(2)}=x^{-1}yxy^{-1}=yc^{-1}y^{-1} \\
      c\phi_{(12)} &= (x^{-1}y^{-1}xy)\phi_{(12)}=(xy)^{-1}y^{-1}(xy)y=y^{-1}cy \\
      c\phi_{(21)} &= (x^{-1}y^{-1}xy)\phi_{(21)}=x^{-1}(yx)^{-1}x(yx)=x^{-1}cx.
    \end{align*}
    Therefore if $\tau$ is an elementary Nielsen transformation of type (T1) or (T2), then $c\phi_\tau=w^{-1}c^{\pm1}w$ for some $w\in F$. The restriction of $\phi$ to $X$ is some regular Nielsen transformation $\tau$. Write $\tau=\tau_1\cdots\tau_k$, where $\tau_i$ is an elementary Nielsen transformation of type (T1) or (T2) for each $1\leq i\leq k$.

    Since $\phi$ and $\phi_{\tau_1}\cdots\phi_{\tau_k}$ agree on $X$, they are equal as automorphisms. We know that $c\phi_{\tau_i}=w_i^{-1}c^{\pm1}w_i$ for some $w_i\in F$. Then for any $w\in F$, we have
    \[ (w^{-1}c^{\pm1}w)\phi_{\tau_i} = (w\phi_{\tau_i})^{-1}(w_i^{-1}c^{\pm1}w_i)^{\pm1}(w\phi_{\tau_i}) = (w_i(w\phi_{\tau_i}))^{-1}c^{\pm1}(w_i(w\phi_{\tau_i})). \]
    By induction, it follows that $c\phi=c\phi_{\tau_1}\cdots\phi_{\tau_k}=w^{-1}c^{\pm1}w$ for some $w\in F$.
  \end{solution}

\question Let $F$ be free of finite rank $r$. Then it was shown in deriving Corollary 7 that $\Aut F$ is generated by $r^2$ elements. Can you improve on this?
  \begin{solution}
    The elements of $\Aut F$ correspond to the regular Nielsen transformations of $X$. When $r=1$, $\abs{\Aut F}=2$, and so any set which generates $\Aut F$ has size at least 1. For $r=2$, let $\tau$ be the transposition given by $(u_1,u_2)\mapsto(u_2,u_1)$.

    By \textbf{1}, $\tau$ is a regular Nielsen transformation. Moreover, $(2')=\tau(1')\tau$ and $(21)=\tau(12)\tau$. Thus the regular Nielsen transformations are generated by $(1'),(12),\tau$, showing that $\Aut F$ can be generated by 3 elements in this case.

    When $r>2$, we will prove that $\Aut F$ is generated by 4 elements. Let $\tau$ be the transposition $(u_1,u_2,\ldots,u_r)\mapsto(u_2,u_1,\ldots,u_r)$, and let $\sigma$ be the $r$-cycle $(u_1,u_2,\ldots,u_r)\mapsto(u_2,\ldots,u_r,u_1)$. By \textbf{1}, $\tau$ and $\sigma$ are regular Nielsen transformations. Moreover they generate the group of permutations of $U$.

    For any $i,j$, let $\tau_{i,j}$ be a permutation of $U$ which puts $u_i$ and $u_j$ in the first and second positions respectively. Then $(ij)=\tau_{i,j}(12)\tau_{i,j}^{-1}$, and $(i')=\tau_{i,j}(1')\tau_{i,j}^{-1}$. Thus $(12)$, $(1')$, $\tau$ and $\sigma$ generate the regular Nielsen transformations, hence $\Aut F$ can be generated by 4 elements in this case.
  \end{solution}

\question Prove that $x^5y^{-1}x^8$, $xyxyx$ are primitive elements of $F(\{x,y\})$, but that $x^2$, $x^{-1}y^{-1}xy$ are not.
  \begin{solution}
    We have
    \begin{align*}
      (x,y)(1)(21)^5(1)(2)(21)^8 &= (x^{-1},y)(21)^5(1)(2)(21)^8 \\
                                 &= (x^{-1},yx^{-5})(1)(2)(21)^8 \\
                                 &= (x,x^5y^{-1})(21)^8 \\
                                 &= (x,x^5y^{-1}x^8),
    \end{align*}
    and
    \[ (x,y)(21)(12)(12) = (x,yx)(12)(12) = (xyxyx,yx). \]
    Thus $\{x,x^5y^{-1}x^8\}$ and $\{xyxyx,yx\}$ are both bases of $F(\{x,y\})$, and hence $x^5y^{-1}x^8$ and $xyxyx$ are primitive elements. If $\{x',y'\}$ is a basis of $F(\{x,y\})$, then the homomorphism determined by $x'\mapsto x$ and $y'\mapsto y$ must be an automorphism.

    Let $\phi$ be an automorphism of $F(\{x,y\})$. Then $x^2\phi=(x\phi)^2$. Since $x\phi\neq e$, we must have $l(x^2\phi)=l((x\phi)^2)\geq2$. Therefore $x^2\phi\neq x$.

    By \textbf{11} we know that if $c=x^{-1}y^{-1}xy$, then $c\phi$ is a conjugate of either $c$ or $c^{-1}$. Since $c$ is cyclically reduced, by \textbf{1.12}, this implies that $\hat{(c\phi)}$ is a cyclic rearrangement of $c$ or $c^{-1}$. Thus $l(c\phi)\geq l(c)=4$, and therefore $c\phi\neq x$.

     It follows that neither $x^2$ nor $x^{-1}y^{-1}xy$ belong to a basis of $F(\{x,y\})$, and hence they are not primitive elements.
  \end{solution}

\question Use Corollary 10 to prove that, for any set $X$, $F(X)$ is residually finite.
  \begin{solution}
    Let $e\neq w=x_1\cdots x_n\in F(X)$ be a reduced word in $X^\pm$. Let $Y=\{x_1^\pm,\ldots,x_n^\pm\}\cap X$. Then $Y$ is finite, and $w=x_1\cdots x_n$ is a reduced word in $Y^\pm$. By Corollary 10, there is a homomorphism $\phi\colon F(Y)\to G$, where $G$ is finite and $w\phi\neq1$. Define $\theta\colon X\to G$ by
    \[ x\theta =
      \begin{cases}
        x\phi & \text{if $x\in Y$,} \\
        1 & \text{otherwise.}
      \end{cases}
    \]
    This extends to a homomorphism $\theta'\colon F(X)\to G$, which agrees with $\phi$ on $F(Y)$. In particular $w\theta'\neq1$. Thus $F(X)$ is residually finite.
  \end{solution}

\question Let $H$ be a subgroup of finite index in a group $G$. Prove that $H$ is residually finite if and only if $G$ is.
  \begin{solution}
    Suppose $G$ is residually finite, and let $e\neq h\in H$. Then there is a homomorphism $\phi\colon G\to F$, with $F$ finite and $h\phi\neq1$. Then $\phi{\restriction_H}\colon H\to F$ satisfies $h\phi{\restriction_H}=h\phi\neq1$. Therefore $H$ is residually finite.

    Conversely, suppose that $H$ is residually finite, and let $e\neq g\in G$. If $g\notin H$, then since $G$ acts on the set of cosets $G/H$, this induces a homomorphism $\phi\colon G\to S_n$, where $n=\abs{G:H}$. Clearly $\ker\phi\leq H$, so $g\phi\neq1$, and $G/\ker\theta$ is finite.

    If $g\in H$, then there exists a homomorphism $\phi\colon H\to F$ with $g\phi\neq1$, for some finite group $F$. Now $\abs{H:\ker\phi}$ and $\abs{G:H}$ are finite, thus $\abs{G:\ker\phi}$ is finite. Since $G$ acts on the set of cosets $G/\ker\phi$, this induces a homomorphism $\phi'\colon G\to S_m$, where $m=\abs{G:\ker\phi}$. Again, $\ker\phi'\leq\ker\theta$, so $g\phi'\neq1$, and $G/\ker\phi'$ is finite.

    It follows that $G$ is residually finite, completing the proof.
  \end{solution}
\end{questions}

%%% Local Variables:
%%% mode: latex
%%% TeX-master: "johnson"
%%% End: